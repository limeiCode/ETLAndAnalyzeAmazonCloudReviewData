{
  "paragraphs": [
    {
      "title": "",
      "text": "%md\n## I. ETL Amazon review data of Software ",
      "user": "",
      "dateUpdated": "2020-01-24 19:07:58.000",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "selectedInterpreter": {
          "name": "md",
          "profile": "md",
          "isCustom": false,
          "editorLanguage": "markdown",
          "className": "org.apache.zeppelin.markdown.Markdown",
          "isDefault": false
        },
        "colWidth": 12.0,
        "editorHide": true,
        "results": [
          {}
        ]
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003eI. ETL Amazon review data of Software\u003c/h2\u003e\n\u003c/div\u003e",
            "type": "HTML"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20200124-182104_410102057",
      "dateCreated": "2020-01-24 18:21:04.000",
      "dateStarted": "2020-01-24 19:07:58.808",
      "dateFinished": "2020-01-24 19:07:58.809",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%md\n### Load Amazon Data into Spark DataFrame",
      "user": "",
      "dateUpdated": "2020-01-24 18:21:37.000",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "selectedInterpreter": {
          "name": "md",
          "profile": "md",
          "isCustom": false,
          "editorLanguage": "markdown",
          "className": "org.apache.zeppelin.markdown.Markdown",
          "isDefault": false
        },
        "colWidth": 12.0,
        "editorHide": true,
        "results": [
          {}
        ]
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003eLoad Amazon Data into Spark DataFrame\u003c/h3\u003e\n\u003c/div\u003e",
            "type": "HTML"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20200124-180701_1705790349",
      "dateCreated": "2020-01-24 18:07:01.000",
      "dateStarted": "2020-01-24 18:21:37.101",
      "dateFinished": "2020-01-24 18:21:37.101",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nfrom pyspark import SparkFiles\nurl \u003d \"https://s3.amazonaws.com/amazon-reviews-pds/tsv/amazon_reviews_us_Software_v1_00.tsv.gz\"\nspark.sparkContext.addFile(url)\nSoftware_df \u003d spark.read.option(\u0027header\u0027, \u0027true\u0027).csv(SparkFiles.get(\"amazon_reviews_us_Software_v1_00.tsv.gz\"), sep\u003d\"\\t\", header\u003dTrue, inferSchema\u003dTrue) \n",
      "user": "",
      "dateUpdated": "2020-01-24 17:23:16.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "",
      "id": "20200109-140301_791171392",
      "dateCreated": "2020-01-09 14:03:01.000",
      "dateStarted": "2020-01-24 17:22:43.916",
      "dateFinished": "2020-01-24 17:23:16.886",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%md\n### Check data ",
      "user": "",
      "dateUpdated": "2020-01-24 18:10:35.000",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "selectedInterpreter": {
          "name": "md",
          "profile": "md",
          "isCustom": false,
          "editorLanguage": "markdown",
          "className": "org.apache.zeppelin.markdown.Markdown",
          "isDefault": false
        },
        "colWidth": 12.0,
        "editorHide": true,
        "results": [
          {}
        ]
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003eCheck data\u003c/h3\u003e\n\u003c/div\u003e",
            "type": "HTML"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20200124-180907_1669855538",
      "dateCreated": "2020-01-24 18:09:07.000",
      "dateStarted": "2020-01-24 18:10:35.603",
      "dateFinished": "2020-01-24 18:10:35.604",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nSoftware_df.show(1)  # show one record to check data type of each field",
      "user": "",
      "dateUpdated": "2020-01-24 17:23:28.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "+-----------+-----------+--------------+----------+--------------+--------------------+----------------+-----------+-------------+-----------+----+-----------------+--------------------+--------------------+-------------------+\n|marketplace|customer_id|     review_id|product_id|product_parent|       product_title|product_category|star_rating|helpful_votes|total_votes|vine|verified_purchase|     review_headline|         review_body|        review_date|\n+-----------+-----------+--------------+----------+--------------+--------------------+----------------+-----------+-------------+-----------+----+-----------------+--------------------+--------------------+-------------------+\n|         US|   42605767|R3EFW2STIYIY0I|B00MUTIDKI|     248732228|McAfee 2015 Inter...|        Software|          1|            2|          2|   N|                Y|I was very disapp...|I was very disapp...|2015-08-31 00:00:00|\n+-----------+-----------+--------------+----------+--------------+--------------------+----------------+-----------+-------------+-----------+----+-----------------+--------------------+--------------------+-------------------+\nonly showing top 1 row\n\n",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20200110-155939_1410448768",
      "dateCreated": "2020-01-10 15:59:39.000",
      "dateStarted": "2020-01-24 17:23:28.123",
      "dateFinished": "2020-01-24 17:23:28.390",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nSoftware_df.count()",
      "user": "",
      "dateUpdated": "2020-01-24 17:23:43.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "341931",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20200110-194809_364706983",
      "dateCreated": "2020-01-10 19:48:09.000",
      "dateStarted": "2020-01-24 17:23:40.406",
      "dateFinished": "2020-01-24 17:23:43.926",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nlen(Software_df.columns)",
      "user": "",
      "dateUpdated": "2020-01-24 17:23:56.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "15",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20200110-190624_413761074",
      "dateCreated": "2020-01-10 19:06:24.000",
      "dateStarted": "2020-01-24 17:23:56.053",
      "dateFinished": "2020-01-24 17:23:56.164",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nSoftware_df.columns",
      "user": "",
      "dateUpdated": "2020-01-24 17:24:05.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "[\u0027marketplace\u0027,\n \u0027customer_id\u0027,\n \u0027review_id\u0027,\n \u0027product_id\u0027,\n \u0027product_parent\u0027,\n \u0027product_title\u0027,\n \u0027product_category\u0027,\n \u0027star_rating\u0027,\n \u0027helpful_votes\u0027,\n \u0027total_votes\u0027,\n \u0027vine\u0027,\n \u0027verified_purchase\u0027,\n \u0027review_headline\u0027,\n \u0027review_body\u0027,\n \u0027review_date\u0027]",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20200110-194733_1512374286",
      "dateCreated": "2020-01-10 19:47:33.000",
      "dateStarted": "2020-01-24 17:24:05.750",
      "dateFinished": "2020-01-24 17:24:05.865",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nSoftware_df.printSchema()",
      "user": "",
      "dateUpdated": "2020-01-24 17:24:24.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "root\n |-- marketplace: string (nullable \u003d true)\n |-- customer_id: integer (nullable \u003d true)\n |-- review_id: string (nullable \u003d true)\n |-- product_id: string (nullable \u003d true)\n |-- product_parent: integer (nullable \u003d true)\n |-- product_title: string (nullable \u003d true)\n |-- product_category: string (nullable \u003d true)\n |-- star_rating: integer (nullable \u003d true)\n |-- helpful_votes: integer (nullable \u003d true)\n |-- total_votes: integer (nullable \u003d true)\n |-- vine: string (nullable \u003d true)\n |-- verified_purchase: string (nullable \u003d true)\n |-- review_headline: string (nullable \u003d true)\n |-- review_body: string (nullable \u003d true)\n |-- review_date: timestamp (nullable \u003d true)\n\n",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20200110-161431_635471303",
      "dateCreated": "2020-01-10 16:14:31.000",
      "dateStarted": "2020-01-24 17:24:24.632",
      "dateFinished": "2020-01-24 17:24:24.745",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nSoftware_df.cache()",
      "user": "",
      "dateUpdated": "2020-01-24 17:24:32.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "DataFrame[marketplace: string, customer_id: int, review_id: string, product_id: string, product_parent: int, product_title: string, product_category: string, star_rating: int, helpful_votes: int, total_votes: int, vine: string, verified_purchase: string, review_headline: string, review_body: string, review_date: timestamp]",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20200109-191140_440172227",
      "dateCreated": "2020-01-09 19:11:40.000",
      "dateStarted": "2020-01-24 17:24:32.845",
      "dateFinished": "2020-01-24 17:24:32.955",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nSoftware_df.select([\"vine\",\"verified_purchase\"]).describe().show()",
      "user": "",
      "dateUpdated": "2020-01-24 17:25:32.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "tableHide": false,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "+-------+------+-----------------+\n|summary|  vine|verified_purchase|\n+-------+------+-----------------+\n|  count|341931|           341931|\n|   mean|  null|             null|\n| stddev|  null|             null|\n|    min|     N|                N|\n|    max|     Y|                Y|\n+-------+------+-----------------+\n\n",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20200110-191125_202021226",
      "dateCreated": "2020-01-10 19:11:25.000",
      "dateStarted": "2020-01-24 17:25:20.449",
      "dateFinished": "2020-01-24 17:25:32.783",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nSoftware_df.select(\"verified_purchase\").filter(\"verified_purchase\u003d\u003dnull\").count()\n",
      "user": "",
      "dateUpdated": "2020-01-24 17:27:15.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "0",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20200110-203140_1522946727",
      "dateCreated": "2020-01-10 20:31:40.000",
      "dateStarted": "2020-01-24 17:27:15.025",
      "dateFinished": "2020-01-24 17:27:15.186",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nSoftware_df.select(\"verified_purchase\").filter(\"verified_purchase\u003d\u003d\u0027Y\u0027\").count()",
      "user": "",
      "dateUpdated": "2020-01-24 17:27:19.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "195647",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20200124-172659_237555909",
      "dateCreated": "2020-01-24 17:26:59.000",
      "dateStarted": "2020-01-24 17:27:18.892",
      "dateFinished": "2020-01-24 17:27:19.054",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%md\n### Cleaned up DataFrames to match DB tables",
      "user": "",
      "dateUpdated": "2020-01-24 18:10:19.000",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "selectedInterpreter": {
          "name": "md",
          "profile": "md",
          "isCustom": false,
          "editorLanguage": "markdown",
          "className": "org.apache.zeppelin.markdown.Markdown",
          "isDefault": false
        },
        "colWidth": 12.0,
        "editorHide": true,
        "results": []
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003eCleaned up DataFrames to match DB tables\u003c/h3\u003e\n\u003c/div\u003e",
            "type": "HTML"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20200124-181003_915505147",
      "dateCreated": "2020-01-24 18:10:03.000",
      "dateStarted": "2020-01-24 18:10:19.890",
      "dateFinished": "2020-01-24 18:10:19.891",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nproducts_df \u003d Software_df.select([\"product_id\", \"product_title\"]).drop_duplicates()\ncustomers_df \u003d Software_df.groupby(\"customer_id\").agg({\"customer_id\": \"count\"}).withColumnRenamed(\"count(customer_id)\", \"customer_count\")\nfrom pyspark.sql.functions import to_date\nreviews_df \u003d Software_df.select([\"review_id\", \"customer_id\", \"product_id\", \"product_parent\", to_date(\"review_date\").alias(\"review_date\")])\nvine_df \u003d Software_df.select([\"review_id\", \"star_rating\", \"helpful_votes\", \"total_votes\", \"vine\"])\nvine_df.show(10)\n",
      "user": "",
      "dateUpdated": "2020-01-24 17:28:51.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "+--------------+-----------+-------------+-----------+----+\n|     review_id|star_rating|helpful_votes|total_votes|vine|\n+--------------+-----------+-------------+-----------+----+\n|R3EFW2STIYIY0I|          1|            2|          2|   N|\n|R12NR0R5A9F7FT|          5|            0|          0|   N|\n|R1LSH74R9XAP59|          2|            0|          1|   N|\n|R1QXUNTF76K7L6|          2|            0|          0|   N|\n|R2F7DR75PS8NKT|          5|            0|          0|   N|\n|R2C1DJSCC8UFS6|          3|            0|          0|   N|\n|R1AXGS1W4YFXMX|          1|            0|          2|   N|\n|R1XU1B93402SYJ|          1|            1|          1|   N|\n|R2U432NB3OPVR0|          5|            0|          0|   N|\n|R3R6FIMIOQ5SP9|          5|            0|          0|   N|\n+--------------+-----------+-------------+-----------+----+\nonly showing top 10 rows\n\n",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20200110-193559_1318240519",
      "dateCreated": "2020-01-10 19:35:59.000",
      "dateStarted": "2020-01-24 17:28:51.069",
      "dateFinished": "2020-01-24 17:28:51.333",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%md\n### Push to AWS RDS instance",
      "user": "",
      "dateUpdated": "2020-01-24 18:18:29.000",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "selectedInterpreter": {
          "name": "md",
          "profile": "md",
          "isCustom": false,
          "editorLanguage": "markdown",
          "className": "org.apache.zeppelin.markdown.Markdown",
          "isDefault": false
        },
        "colWidth": 12.0,
        "editorHide": true,
        "results": [
          {}
        ]
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003ePush to AWS RDS instance\u003c/h3\u003e\n\u003c/div\u003e",
            "type": "HTML"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20200124-181105_1431887941",
      "dateCreated": "2020-01-24 18:11:05.000",
      "dateStarted": "2020-01-24 18:18:29.912",
      "dateFinished": "2020-01-24 18:18:29.914",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nmode \u003d \"append\"\njdbc_url\u003d\"jdbc:postgresql://\u003cEndPoint\u003e:5432/\u003cDBName\u003e\"\nconfig \u003d {\"user\":\"root\", \"password\": \"\u003cPW\u003e\", \"driver\":\"org.postgresql.Driver\"}\n",
      "user": "",
      "dateUpdated": "2020-01-24 19:09:56.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "",
      "id": "20200110-215349_529543443",
      "dateCreated": "2020-01-10 21:53:49.000",
      "dateStarted": "2020-01-24 18:37:48.283",
      "dateFinished": "2020-01-24 18:37:48.392",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nproducts_df.write.jdbc(url\u003djdbc_url, table\u003d\u0027products\u0027, mode\u003dmode, properties\u003dconfig)\ncustomers_df.write.jdbc(url\u003djdbc_url, table\u003d\u0027customers\u0027, mode\u003dmode, properties\u003dconfig)\nreviews_df.write.jdbc(url\u003djdbc_url, table\u003d\u0027reviews\u0027, mode\u003dmode, properties\u003dconfig)\nvine_df.write.jdbc(url\u003djdbc_url, table\u003d\u0027vine\u0027, mode\u003dmode, properties\u003dconfig)\n",
      "user": "",
      "dateUpdated": "2020-01-24 19:08:46.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "",
      "id": "20200109-004353_450034940",
      "dateCreated": "2020-01-09 00:43:53.000",
      "dateStarted": "2020-01-24 18:46:13.352",
      "dateFinished": "2020-01-24 18:49:49.799",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%md\n## II. Analyze Wine Program",
      "user": "",
      "dateUpdated": "2020-01-24 18:23:29.000",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "selectedInterpreter": {
          "name": "md",
          "profile": "md",
          "isCustom": false,
          "editorLanguage": "markdown",
          "className": "org.apache.zeppelin.markdown.Markdown",
          "isDefault": false
        },
        "colWidth": 12.0,
        "editorHide": true,
        "results": [
          {}
        ]
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003eII. Analyze Wine Program\u003c/h2\u003e\n\u003c/div\u003e",
            "type": "HTML"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20200124-181540_1750829525",
      "dateCreated": "2020-01-24 18:15:40.000",
      "dateStarted": "2020-01-24 18:23:29.597",
      "dateFinished": "2020-01-24 18:23:29.597",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%md\n### Filter by votes",
      "user": "",
      "dateUpdated": "2020-01-24 18:19:05.000",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "selectedInterpreter": {
          "name": "md",
          "profile": "md",
          "isCustom": false,
          "editorLanguage": "markdown",
          "className": "org.apache.zeppelin.markdown.Markdown",
          "isDefault": false
        },
        "colWidth": 12.0,
        "editorHide": true,
        "results": [
          {}
        ]
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003eFilter by votes\u003c/h3\u003e\n\u003c/div\u003e",
            "type": "HTML"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20200124-181758_1783839188",
      "dateCreated": "2020-01-24 18:17:58.000",
      "dateStarted": "2020-01-24 18:19:05.629",
      "dateFinished": "2020-01-24 18:19:05.629",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nvine_df \u003d Software_df.select([\"star_rating\", \"helpful_votes\", \"total_votes\", \"vine\", \"verified_purchase\"])\nvine_filtertotalvotes_df \u003d vine_df.filter(vine_df[\"total_votes\"] \u003e\u003d 20)\nvine_filtertotalvoteshelpfulvotes_df \u003d vine_filtertotalvotes_df.filter(vine_filtertotalvotes_df[\"helpful_votes\"]/vine_filtertotalvotes_df[\"total_votes\"] \u003e\u003d 0.5)\n",
      "user": "",
      "dateUpdated": "2020-01-24 18:54:23.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "jobName": "",
      "id": "20200110-224402_872381009",
      "dateCreated": "2020-01-10 22:44:02.000",
      "dateStarted": "2020-01-24 18:54:23.266",
      "dateFinished": "2020-01-24 18:54:23.426",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%md\n### Describe Stats",
      "user": "",
      "dateUpdated": "2020-01-24 18:19:38.000",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "selectedInterpreter": {
          "name": "md",
          "profile": "md",
          "isCustom": false,
          "editorLanguage": "markdown",
          "className": "org.apache.zeppelin.markdown.Markdown",
          "isDefault": false
        },
        "colWidth": 12.0,
        "editorHide": true,
        "results": []
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003eDescribe Stats\u003c/h3\u003e\n\u003c/div\u003e",
            "type": "HTML"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20200124-181934_1872196894",
      "dateCreated": "2020-01-24 18:19:34.000",
      "dateStarted": "2020-01-24 18:19:38.480",
      "dateFinished": "2020-01-24 18:19:38.480",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nfrom pyspark.sql.functions import col, avg\npaid_df \u003d vine_filtertotalvoteshelpfulvotes_df.filter(vine_filtertotalvoteshelpfulvotes_df[\u0027vine\u0027]\u003d\u003d \u0027Y\u0027)\nunpaid_df \u003d vine_filtertotalvoteshelpfulvotes_df.filter(vine_filtertotalvoteshelpfulvotes_df[\u0027vine\u0027]\u003d\u003d \u0027N\u0027)\n\npaid_df.describe().show()\nunpaid_df.describe().show()",
      "user": "",
      "dateUpdated": "2020-01-24 18:55:41.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {},
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "+-------+------------------+------------------+------------------+----+-----------------+\n|summary|       star_rating|     helpful_votes|       total_votes|vine|verified_purchase|\n+-------+------------------+------------------+------------------+----+-----------------+\n|  count|               248|               248|               248| 248|              248|\n|   mean|3.7943548387096775| 77.65725806451613| 81.91129032258064|null|             null|\n| stddev| 1.304790452368455|142.24734497903623|145.08341937129128|null|             null|\n|    min|                 1|                15|                20|   Y|                N|\n|    max|                 5|              1231|              1247|   Y|                Y|\n+-------+------------------+------------------+------------------+----+-----------------+\n\n\n",
            "type": "TEXT"
          },
          {
            "data": "+-------+------------------+-----------------+-----------------+-----+-----------------+\n|summary|       star_rating|    helpful_votes|      total_votes| vine|verified_purchase|\n+-------+------------------+-----------------+-----------------+-----+-----------------+\n|  count|             17514|            17514|            17514|17514|            17514|\n|   mean|2.8756423432682428|46.32185680027407|51.29542080621217| null|             null|\n| stddev|1.6981277376160198|68.69833838338252|72.36000784694947| null|             null|\n|    min|                 1|               10|               20|    N|                N|\n|    max|                 5|             2243|             2394|    N|                Y|\n+-------+------------------+-----------------+-----------------+-----+-----------------+\n\n",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20200110-225008_1989106232",
      "dateCreated": "2020-01-10 22:50:08.000",
      "dateStarted": "2020-01-24 18:55:40.185",
      "dateFinished": "2020-01-24 18:55:41.047",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%md\n### Determine the percentage of five-star reviews among Vine reviews",
      "user": "",
      "dateUpdated": "2020-01-24 18:20:12.000",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "selectedInterpreter": {
          "name": "md",
          "profile": "md",
          "isCustom": false,
          "editorLanguage": "markdown",
          "className": "org.apache.zeppelin.markdown.Markdown",
          "isDefault": false
        },
        "colWidth": 12.0,
        "editorHide": true,
        "results": []
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003eDetermine the percentage of five-star reviews among Vine reviews\u003c/h3\u003e\n\u003c/div\u003e",
            "type": "HTML"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20200124-182007_843184987",
      "dateCreated": "2020-01-24 18:20:07.000",
      "dateStarted": "2020-01-24 18:20:12.592",
      "dateFinished": "2020-01-24 18:20:12.593",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\npaid_five_star_number \u003d paid_df[paid_df[\u0027star_rating\u0027]\u003d\u003d 5].count()\npaid_number \u003d paid_df.count()\npercentage_five_star_vine \u003d float(paid_five_star_number) / float(paid_number)\nprint(\"paid_number\",paid_number)\nprint(\"paid_five_star_number\",paid_five_star_number)\nprint(\"percentage_five_star_vine\",percentage_five_star_vine)",
      "user": "",
      "dateUpdated": "2020-01-24 18:55:51.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "(\u0027paid_number\u0027, 248)\n(\u0027paid_five_star_number\u0027, 102)\n(\u0027percentage_five_star_vine\u0027, 0.4112903225806452)\n",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20200110-225118_410601049",
      "dateCreated": "2020-01-10 22:51:18.000",
      "dateStarted": "2020-01-24 18:55:50.940",
      "dateFinished": "2020-01-24 18:55:51.300",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%md\n### Determine the percentage of five-star reviews among non-Vine reviews",
      "user": "",
      "dateUpdated": "2020-01-24 18:20:42.000",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "selectedInterpreter": {
          "name": "md",
          "profile": "md",
          "isCustom": false,
          "editorLanguage": "markdown",
          "className": "org.apache.zeppelin.markdown.Markdown",
          "isDefault": false
        },
        "colWidth": 12.0,
        "editorHide": true,
        "results": []
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch3\u003eDetermine the percentage of five-star reviews among non-Vine reviews\u003c/h3\u003e\n\u003c/div\u003e",
            "type": "HTML"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20200124-182016_2110579943",
      "dateCreated": "2020-01-24 18:20:16.000",
      "dateStarted": "2020-01-24 18:20:42.891",
      "dateFinished": "2020-01-24 18:20:42.891",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "%pyspark\nunpaid_five_star_number \u003d unpaid_df[unpaid_df[\u0027star_rating\u0027]\u003d\u003d 5].count()\nunpaid_number \u003d unpaid_df.count()\npercentage_five_star_non_vine \u003d float(unpaid_five_star_number) / float(unpaid_number)\nprint(\"unpaid_number\",unpaid_number)\nprint(\"unpaid_five_star_number\",unpaid_five_star_number)\nprint(\"unpaid_five_star_number/unpaid_number\",float(unpaid_five_star_number) / float(unpaid_number))\n",
      "user": "",
      "dateUpdated": "2020-01-24 18:55:57.000",
      "config": {
        "selectedInterpreter": {
          "name": "spark.pyspark",
          "profile": "pyspark",
          "isCustom": false,
          "editorLanguage": "python",
          "className": "org.apache.zeppelin.spark.PySparkInterpreter",
          "isDefault": false
        },
        "colWidth": 12.0,
        "results": [
          {}
        ],
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "data": "(\u0027unpaid_number\u0027, 17514)\n(\u0027unpaid_five_star_number\u0027, 5154)\n(\u0027unpaid_five_star_number/unpaid_number\u0027, 0.29427886262418634)\n",
            "type": "TEXT"
          }
        ]
      },
      "apps": [],
      "jobName": "",
      "id": "20200110-221808_265835090",
      "dateCreated": "2020-01-10 22:18:08.000",
      "dateStarted": "2020-01-24 18:55:57.121",
      "dateFinished": "2020-01-24 18:55:57.330",
      "status": "FINISHED",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    },
    {
      "title": "",
      "text": "",
      "user": "",
      "dateUpdated": "2020-01-10 22:52:29.000",
      "config": {},
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "",
      "id": "20200110-225229_399373269",
      "dateCreated": "2020-01-10 22:52:29.000",
      "dateStarted": "2020-01-10 23:05:51.000",
      "dateFinished": "2020-01-10 23:05:51.000",
      "status": "READY",
      "errorMessage": "",
      "progressUpdateIntervalMs": 0
    }
  ],
  "name": "ETLAndAnalyzeAmazonReviewData ",
  "id": "73d795bc52ea489e8a99ac08c86ba7bd",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {},
  "config": {},
  "info": {}
}